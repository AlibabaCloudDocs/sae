# 管理定时启停规则

定时启停功能可实现按命名空间定时批量启停应用，例如定时启停开发环境或测试环境的全部应用，帮助您提高硬件资产利用率、降低资源闲置成本。

## 准备工作

命名空间应用定时启停功能依赖运维编排服务OOS，请先创建OOSServiceRole RAM角色，并为该角色赋予管理SAE的完整权限AliyunSAEFullAccess。

**说明：** 如果您已经创建OOSServiceRole角色，则只需为其添加权限AliyunSAEFullAccess。

1.  登录[访问控制RAM控制台](https://ram.console.aliyun.com/)。

2.  在左侧导航栏单击**RAM角色管理**，并在**RAM角色管理**页面单击**创建RAM角色**。

3.  在**创建RAM角色**面板的**选择类型**页面上选择**阿里云服务**，并单击**下一步**。

    ![ram_panel_creat_ram_role](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7353649951/p127390.png)

4.  在**配置角色**页面的**角色类型**区域选择**普通服务角色**，输入角色名称OOSServiceRole，在**选择受信服务**区域选择**运维编排服务**，并单击**完成**。

    ![ram_panel_creat_ram_role_tab_config_role](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7353649951/p127396.png)

5.  在**创建完成**页面上，单击**为角色授权**。

6.  在**添加权限**面板的**选择权限**区域，选择**系统策略**，在输入框中输入关键字sae，单击搜索结果中的**AliyunSAEFullAccess**，然后单击确定。

    ![ram_panel_add_permission_for_ram_role](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7353649951/p127397.png)


## 创建定时启停规则

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**命名空间**，在顶部菜单栏选择目标地域。

3.  在**命名空间**页面上，执行以下操作之一以进入命名空间详情页面。

    -   单击目标命名空间的名称。
    -   在目标命名空间的**操作**列中单击**详情**。
4.  在左侧导航栏单击**定时启停规则**，在**定时启停规则**页面单击**创建定时启停规则**。

5.  在**创建定时启停规则**面板上，配置规则信息，并单击**确定**。

    ![panel_create_scheduled_start_stop_rules ](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/7353649951/p118118.png)

    参数说明如下。

    |参数|说明|
    |--|--|
    |规则名称|定时启停规则的名称。必须以小写字母开头，以数字或小写字母结尾，仅可包含小写字母、中文字符、数字及短划线（-），不超过63个字符。|
    |触发动作|    -   **批量启动应用**：批量启动本命名空间下选中的应用。
    -   **批量停止应用**：批量停止本命名空间下选中的应用。 |
    |执行频率|    -   **仅执行一次**：在指定日期和时间执行一次后不再执行。
    -   **定期执行**：按照指定的日期和时间循环执行。
        -   **日粒度**：指定每个月需要执行的具体日期和时间，每月循环。
        -   **周粒度**：指定每周需要执行的具体日期和时间，每周循环。
        -   **高级**：使用Crontab表达式定义执行时间，各字段的取值范围如下所示：
            -   **分**（分钟）：0分~59分。
            -   **时**（小时）：0时~23时，0表示午夜0时。
            -   **日**（每个月的具体日期）：1日~31日。
            -   **月**：不可修改，1月~12月。
            -   **周**（星期）：1~7，1表示星期日，2表示星期一，依次类推。 |
    |执行前通知配置|配置一个钉钉机器人Webhook地址，SAE将在每次开始执行定时任务前向此处指定的钉钉机器人发送通知，方便您第一时间获取系统运维动作信息。|
    |触发的应用列表|选中需要执行启动或停止操作的应用。|

    创建好的规则将显示在**定时启停规则**页面上，且默认为启用状态。


## 使用Crontab表达式

借助Crontab表达式，可以定义更灵活的定时启停规则触发时间和循环规律。

使用Crontab表达式时需要注意以下事项：

-   只能按**日**或**周**指定启停触发时间，如果指定了其中一个，另一个则必须填写通配符`?`，表示不加限制。例如，如果指定每个月第1日、第2日，则必须在**周**输入框中填写`?`。
-   在Crontab表达式内必须使用英文半角字符，例如英文通配符星号（\*）、问号（?）。
-   枚举值之间用英文逗号（,）分隔。
-   值的区间用短划线（-）表示，例如：**日**输入框中填写`1-5`，表示第1日~第5日。
-   填写周时，1表示周日，7表示周六，即每周从周日到周六的数字为1~7。

|含义|填写方法|Crontab表达式|
|--|----|----------|
|每周一至周五22:30|`30`分`22`时`?`日`*`月`1-5`周|30 22 \* 1-5|
|每个月第5日、第15日和第25日的0时|`0`分`0`时`5,15,25`日`*`月`?`周|0 0 5,15,25 \* ?|

## 管理定时启停规则

如需管理定时启停规则，例如查看规则详情、编辑规则等，请在**定时启停规则**页面上按照以下步骤执行：

-   如需查看规则详情，单击规则名称。
-   如需查看最近一次定时规则触发后的执行过程信息和执行结果，单击**最近一次触发时间**列中的**变更单详情**，并在**变更详情**页面查看详细信息。
-   如需启用或停用规则，单击**操作**列中的**启用**或**停用**。
-   如需编辑规则，单击**操作**列中的**编辑**，并按照[创建定时启停规则](#section_ay5_npa_6cm)的说明编辑规则内容。
-   如需删除规则，单击**操作**列中的**删除**。

## 问题反馈

如果您在使用SAE过程中有任何疑问，欢迎您扫描下面的二维码或搜索群号23198618，加入钉钉群与我们交流。

![SAE钉钉群2](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/4279867061/p72048.png)

**相关文档**  


[什么是运维编排服务]()

