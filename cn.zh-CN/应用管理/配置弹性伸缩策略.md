---
keyword: [扩容, 缩容, 弹性伸缩, 自动弹性, SAE自动弹性]
---

# 配置弹性伸缩策略

在分布式应用管理中，弹性伸缩是很重要的运维能力，它能够根据实例状态自动增加或减少实例数量，即扩容或缩容，从而提高资源利用率、降低资源成本。本文介绍设置SAE定时弹性策略或者监控指标弹性策略的操作步骤。

## 适用场景

-   [配置定时弹性伸缩策略](#section_2qv_mhm_pk6)：适用于资源使用率有周期性规律的应用场景，多用于证券、医疗、政府和教育等行业。
-   [配置监控指标弹性伸缩策略](#section02)：适用于突发流量和典型周期性流量的应用场景，多用于互联网、游戏和社交平台等行业。

## 使用须知

-   您最多可以创建5条弹性策略或1条监控指标弹性策略。
-   定时弹性与监控指标弹性暂不支持同时开启。
-   弹性策略启用时，请勿手动进行应用生命周期管理操作，例如应用扩缩、部署应用、更改规格、重启应用、停止应用。如果您需要对应用进行该类操作，那么请停用弹性策略后，再手动执行操作。
-   如果当前应用处于扩容、缩容、部署（单批、分批或灰度）、更改规格、重启、停止等过程中，那么该应用暂时无法添加或者启动弹性策略。

## 配置定时弹性伸缩策略

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面上方选择**地域**，单击具体应用名称。

3.  在**基本信息**页面单击**实例部署信息**，在**实例部署信息**页签展开**弹性伸缩**区域，单击**+添加弹性策略**。

    ![SAE添加弹性策略入口 ](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4253649951/p129759.png)

4.  在**添加弹性策略**面板，设置策略参数。

    ![添加弹性策略](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3808101061/p56541.png)

    参数说明如下。

    |参数|说明|
    |--|--|
    |策略类型|选择**定时策略**。|
    |策略名称|自定义的策略名称，必须以小写字母开头，仅可包含小写字母、数字及短划线（-），不超过32个字符。|
    |选择时间|    -   **短期**：适用于需要指定执行定时弹性伸缩策略的起止日期时的场景。
    -   **长期**：适用于不需要指定执行定时弹性伸缩策略的结束日期时的场景。 |
    |周期|执行定时弹性伸缩策略的周期。    -   **每天**：每天指定时间执行定时策略。
    -   **每周**：每周指定天数的指定时间执行定时策略。
    -   **每月**：每月指定日期的指定时间执行定时策略。 |
    |单天内的触发时间|设置弹性伸缩策略触发的时间，以及该时间段内需要保持的应用实例数。例如：如果**周期**设为**每天**，第一条定时策略触发开始时间为8:00，目标实例数为10个，第二条定时策略开始时间为20:00，目标实例数为3个，则在8:00至20:00之间，SAE依据所设的规则，将该应用的实例数保持为10个，在20:00至次日8:00之间，应用实例数保持为3个。 |

    **说明：**

    -   单条定时策略内设置的触发时间，不能小于系统当前时间，如果小于当前时间，该策略将在下个执行周期内生效。
    -   单条定时策略内的两个邻近时间间隔须大于5分钟。如果您设置了多条定时策略，SAE会检查重复日期内的多个触发时间点的时间间隔。
    -   如果设置了多条定时策略，并且两个触发点时间重复，那么遵循以新盖旧的原则，以最后添加的触发点策略为准。设置定时策略时请您避免时间冲突的情况。
5.  单击**下一步：预览定时策略**确认策略信息，单击**确认**。

6.  策略设置完成后，在**实例部署信息**页签，单击目标策略**操作**列的**启用**。

7.  在**启用弹性策略**对话框中单击**确认**，启用该策略。

    当该策略的**状态**切换至**已启用**时，说明策略启用成功。

    ![启用定时策略](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/3808101061/p170276.png)


## 配置监控指标弹性伸缩策略

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面上方选择**地域**，单击具体应用名称。

3.  在**基本信息**页面单击**实例部署信息**，在**实例部署信息**页签展开**弹性伸缩**折叠区域，单击**+添加弹性策略**。

    ![SAE添加弹性策略入口 ](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4253649951/p129759.png)

4.  在**添加弹性策略**对话框中单击**监控指标策略**页签，在**监控指标策略**页签设置策略参数，单击**确认**。

    ![SAEHPA弹性策略设置](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4808101061/p66617.png)

    参数说明如下。

    |参数|说明|
    |--|--|
    |策略类型|选择**监控指标策略**。|
    |策略名称|自定义的策略名称，必须以小写字母开头，仅可包含小写字母、数字及短划线（-），不超过32个字符。|
    |触发条件|设置以下监控指标中的一个或多个。    -   **CPU使用率**
    -   **内存使用率**
    -   **应用QPS**
    -   **响应时间（RT）**
**说明：**

    -   当**应用监控**页面最近30分钟内有应用QPS或响应时间（RT）数据时才可以设置该项指标。
    -   当设置多个监控指标时，只要任何一个指标大于或者等于目标值，则应用进行扩容，扩容后实例数不高于**应用最大实例数**；如果所有指标均小于目标值，则应用进行缩容，缩容后实例数不低于**应用最小实例数**。 |
    |实例数设置|您可以直接设置输入实例数或者滑动下方的指针设置实例数。    -   **应用最小实例数**：触发弹性伸缩条件后，应用缩容，其实例数可达到的目标值。取值范围\[1,50\]。
    -   **应用最大实例数**：触发弹性伸缩条件后，应用扩容，其实例数可达到的目标值。取值范围\[2,50\]。 |
    |最小存活实例数|每次部署最小存活的实例数。单击**设置**，在**设置最小存活实例数对话框**中设置最小存活实例数量。**说明：** 每次滚动部署最小存活的实例数建议大于等于1，保证业务不中断。如果设置为0，应用在升级过程中将会中断业务。 |

5.  策略设置完成后，在**实例部署信息**页签，单击目标策略**操作**列的**启用**。

6.  在**启用弹性策略**对话框中单击**确认**，启用该策略。

    当该策略的**状态**切换至**已启用**时，说明策略启用成功。

    ![启用监控指标策略](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4808101061/p170277.png)


## 验证弹性伸缩策略

启用弹性策略后，SAE会自动监控应用状态，当满足触发条件时，SAE依据弹性策略进行应用实例扩容或缩容。您可以通过以下步骤验证弹性伸缩策略是否生效。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面上方选择**地域**，单击具体应用名称。

3.  在**基本信息**页面的**应用信息**区域查看应用**运行实例数**。

    如果**运行实例数**与弹性策略中设置的实例数一致，说明弹性策略已生效。

    ![应用实例数](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8835021061/p170806.png)

4.  您可以通过以下方式查看弹性伸缩原因。

    -   查看应用事件：

        在左侧导航栏单击**应用事件**，在左侧事件原因中选择**自动弹性（HorizontalPodAutoscaler）**，查看弹性伸缩原因。

    -   查看自动弹性事件：
        1.  在**基本信息**页面单击**实例部署信息**，在**实例部署信息**页签展开**弹性伸缩**区域。
        2.  单击目标策略**操作**列的![更多](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5253649951/p129713.png)图标并在快捷菜单中单击**事件**，查看自动弹性原因。
    ![弹性伸缩事件](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/8835021061/p170805.png)


## 查看和管理已配置的弹性策略

为应用配置弹性伸缩策略后，您可以在**实例部署信息**页签上查看已配置策略的详细信息。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面上方选择**地域**，单击具体应用名称。

3.  在**基本信息**页面单击**实例部署信息**页签，展开**弹性伸缩**折叠区域，在指定策略的**操作**列中，您可以执行以下操作。

    ![tab_instance_deploy_info_sc_hpa_rules](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/4253649951/p127518.png)

    -   **启用**：单击**启用**来启动策略。
    -   **停止**：单击**停止**来停止策略。
    -   **编辑**：单击**编辑**来编辑策略。
    -   **删除**：单击![更多](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5253649951/p129713.png)图标并在快捷菜单中单击**删除**来删除策略
    -   查看**事件**：单击![更多](https://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/zh-CN/5253649951/p129713.png)图标并在快捷菜单中单击**事件**来查看自动弹性事件。

