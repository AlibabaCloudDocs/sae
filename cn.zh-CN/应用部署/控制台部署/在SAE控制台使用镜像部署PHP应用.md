# 在SAE控制台使用镜像部署PHP应用

您可以通过SAE控制台使用上传至阿里云容器镜像服务的镜像来部署PHP应用，支持的镜像包括您阿里云账号下的镜像和可通过公网访问的公有镜像。本文介绍如何在SAE控制台使用镜像部署PHP应用。

-   [创建VPC](/cn.zh-CN/快速入门/准备工作.md)。
-   [创建命名空间](/cn.zh-CN/快速入门/准备工作.md)。
-   [制作应用镜像](https://help.aliyun.com/document_detail/98492.html)。

在SAE上部署应用的方式如下表所示。

|应用举例|部署方式|应用包参考文档|
|----|----|-------|
|原生Spring Cloud|WAR、JAR、镜像|[将Spring Cloud应用托管到SAE](/cn.zh-CN/快速入门/微服务应用入门/将Spring Cloud应用托管到SAE.md)|
|原生Dubbo|WAR、JAR、镜像|[将Dubbo应用托管到SAE](/cn.zh-CN/快速入门/微服务应用入门/将Dubbo应用托管到SAE.md)|
|HSF|WAR、JAR、镜像|无|
|多语言应用|镜像|无|

## 可选：在容器镜像服务ACR控制台配置镜像同步

如果要使用的阿里云镜像仓库与您的应用不在同一个地域，您需要先使用容器镜像服务ACR的镜像同步功能将该镜像仓库同步至应用所在的地域，再部署应用。

1.  登录[容器镜像服务ACR控制台](https://cr.console.aliyun.com/)，在顶部菜单栏选择地域。

2.  在左侧导航栏选择**默认实例** \> **镜像仓库**，在**镜像仓库**页面单击镜像仓库名称。

3.  在左侧导航栏单击**镜像同步**，在页面右上角单击**创建同步任务**。

4.  在**镜像同步**对话框中输入以下信息并单击**确认**。

    ![acr_db_image_sync](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1523960061/p127728.png)

    -   **镜像版本**：当前镜像的版本。
    -   **目标仓库**：依次输入目标仓库的地域（即您的应用所在的地域）、命名空间、仓库名称和版本号。
    镜像同步完成后，在[容器镜像服务ACR控制台](https://cr.console.aliyun.com/)上选择的镜像仓库将同步至此处选择的目标仓库。随后您将可以在[SAE控制台](https://sae.console.aliyun.com/)的**应用部署配置**页面上选择该镜像。


## 部署应用

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面上方选择**地域**，单击**创建应用**。

3.  在**应用基本信息**页签，设置应用相关信息，配置完成后单击**下一步：应用部署配置**。

    ![Application_deployment_basic_information](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/0503534261/p60491.png)

    参数说明如下表所示。

    |参数名|说明|
    |---|--|
    |应用名称|输入应用名称。允许数字、字母、下划线（\_）以及短划线（-）组合，仅允许字母开头，不超过36个字符。|
    |专有网络配置|选择专有网络的配置方式。    -   **自定义配置**：选中后，您可以为创建的应用选择所需的命名空间、VPC、vSwitch及安全组。
    -   **自动配置**：选中后，SAE将自动帮您配置命名空间、VPC、vSwitch及安全组，无需手动选择。 |
    |命名空间|在下拉菜单中选择创建好的命名空间。仅**自定义配置**专有网络时需要选择。**说明：** 命名空间和VPC是一一映射关系，关于修改VPC的更多信息，请参见[切换专有网络VPC和虚拟交换机](/cn.zh-CN/RDS MySQL 数据库/数据库连接/切换专有网络VPC和虚拟交换机.md)。 |
    |vSwitch|在下拉菜单中选择vSwitch。仅**自定义配置**专有网络时需要选择。vSwitch数量至少需要配置1个，建议不超过3个，且每个vSwitch至少匹配1个应用实例。 |
    |安全组|在下拉菜单中选择安全组。仅**自定义配置**专有网络时需要选择。**说明：** 如果您的VPC内没有创建安全组，请单击**创建安全组**，根据提示创建安全组。更多信息，请参见[创建安全组](/cn.zh-CN/安全/安全组/创建安全组.md)。 |
    |应用实例数|选择需要创建的实例个数。|
    |VCPU|选择需要创建的实例CPU规格。|
    |内存|选择需要创建的实例内存规格。|
    |应用描述|填写应用的基本情况，输入的描述信息不超过100个字符。|

4.  在**应用部署配置**页签，配置相关参数。

    ![sc_config_image](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1088560061/p127139.png)

    参数说明如下所示：

    |参数名|说明|
    |---|--|
    |技术栈语言|SAE支持**Java**、**PHP**及**其他语言**。本文中部署的语言为**PHP**。|
    |技术栈版本|选择PHP应用的语言版本。仅**技术栈语言**为**PHP**时需要设置。**说明：** 请选择正确的**技术栈版本**，错误版本可能会导致PHP应用运行异常。 |
    |应用部署方式|选择**镜像**。|
    |配置镜像|指定部署应用的镜像文件。    -   **我的阿里云镜像**：选择您的阿里云账号下的且已上传至阿里云容器镜像服务的镜像文件及其版本。您可以通过**镜像仓库命名空间**和**镜像仓库名**来快速筛选目标镜像文件。

**说明：** 如果要使用的阿里云镜像仓库与您的应用不在同一个地域，则需要先使用容器镜像服务ACR的镜像同步功能将该镜像仓库同步至应用所在的地域。详情请参见[可选：在容器镜像服务ACR控制台配置镜像同步](#section_acj_b5c_96b)。

    -   **公有镜像**：输入可通过公网访问的公共镜像的完整镜像地址。

**说明：** 如需使用公有镜像，请确保VPC能够访问公网。 |

5.  您可以根据需要设置以下高级选项。

    |高级设置|是否必选|参考文档|
    |----|----|----|
    |设置PHP应用监控|否|[设置PHP应用监控](/cn.zh-CN/应用部署/设置PHP应用监控.md)**说明：** 仅**技术栈语言**为**PHP**时可以设置。 |
    |设置PHP应用配置文件|否|[设置PHP应用配置文件](/cn.zh-CN/应用部署/设置PHP应用配置文件.md)**说明：** 仅**技术栈语言**为**PHP**时可以设置。 |
    |启动命令|否|[设置启动命令](/cn.zh-CN/应用部署/设置启动命令.md)|
    |环境变量|否|[设置环境变量](/cn.zh-CN/应用部署/设置环境变量.md)|
    |Hosts绑定|否|[设置Hosts绑定](/cn.zh-CN/应用部署/设置Hosts绑定.md)|
    |应用健康检查|否|[设置健康检查](/cn.zh-CN/应用部署/设置健康检查.md)|
    |应用生命周期管理|否|[设置应用生命周期管理](/cn.zh-CN/应用部署/设置应用生命周期管理.md)|
    |日志收集|否|[设置日志收集](/cn.zh-CN/应用部署/设置日志收集.md)|
    |持久化存储|否|[设置NAS存储](/cn.zh-CN/应用部署/设置NAS存储.md)|
    |配置管理|否|[注入配置信息](/cn.zh-CN/应用部署/注入配置信息.md)|

6.  单击**下一步：确认规格**。

7.  在**确认规格**页签，查看您所创建应用的详细信息以及费用配置情况，并单击**确认创建**。


## 结果验证

应用部署后，您可以通过以下两种方式验证应用的部署结果：

-   查看应用实例运行状态。
    1.  登录[SAE控制台](https://sae.console.aliyun.com)。
    2.  在左侧导航栏单击**应用列表**，在**应用列表**页面单击具体应用。
    3.  在**应用详情**页面的**实例部署信息**页签查看实例的运行状态。

        如果**运行状态**显示为绿色的Running或者Completed，表示应用部署成功。

-   配置公网负载均衡并访问应用。

    应用部署后，根据实际需要，通过配置负载均衡SLB在指定范围内开放应用访问，以便其他应用访问。

    负载均衡包括如下两种：

    -   私网负载均衡：在应用所在的VPC内提供应用的访问入口，保证应用能被同VPC内的其它应用访问。
    -   公网负载均衡：为该应用自动购买公网SLB服务，或者复用在SLB控制台已购买的实例，保证应用能被公网中的其它应用访问。
    **说明：** 配置公网SLB访问和配置私网SLB访问的步骤相同，具体操作请参见[为应用绑定SLB](/cn.zh-CN/应用管理/绑定SLB/为应用绑定SLB.md)。SLB绑定完成后，在浏览器输入由SLB的IP地址、端口及应用部署包名组成的访问地址并访问，例如192.168.XX.XX/80/image，即可进入应用。


## 查看应用监控指标

应用成功部署后，您可以在**应用监控**模块中查看应用的关键性能指标。

1.  登录[SAE控制台](https://sae.console.aliyun.com)。

2.  在左侧导航栏单击**应用列表**，在**应用列表**页面上方选择**地域**，单击具体应用名称。

3.  在左侧导航栏按需查看应用监控数据：

    -   **应用总览**：选择**应用监控** \> **应用总览**，查看应用的关键性能指标，例如总请求量、平均响应时间等。
    -   **应用详情**：选择**应用监控** \> **应用详情**，查看更全面的应用监控数据，例如JVM监控、主机监控和异常分析等。
    -   **接口调用**：选择**应用监控** \> **接口调用**，查看以接口为维度的监控数据，例如调用拓扑图、链路上游和链路下游等。
    -   **高级监控**：选择**应用监控** \> **高级监控**，查看更高性能的监控管理数据，例如应用全局拓扑、异常SQL分析和本地调用堆栈等。

## 更多信息

-   您在SAE部署完应用后，可以对应用进行更新、扩缩容、启停、删除应用等生命周期管理操作。具体操作，请参见[管理应用生命周期](/cn.zh-CN/应用管理/应用生命周期/管理应用生命周期.md)。
-   您在SAE部署完应用后，可以对应用进行自动弹性伸缩、SLB绑定和批量启停等提升应用性能的操作。具体操作，请参见以下文档：
    -   [绑定SLB](/cn.zh-CN/应用管理/绑定SLB/为应用绑定SLB.md)
    -   [配置弹性伸缩策略](/cn.zh-CN/应用管理/应用实例/配置弹性伸缩策略.md)
    -   [一键启停应用](/cn.zh-CN/应用管理/应用生命周期/一键启停应用.md)
    -   [配置管理](/cn.zh-CN/应用管理/ACM配置管理/配置管理概述.md)
    -   [变更实例规格](/cn.zh-CN/应用管理/应用实例/变更实例规格.md)
-   您在SAE部署完应用后，还可以对应用进行日志管理、监控管理、应用事件查看和变更记录查看等聚焦应用运行状态的操作。具体操作，请参见以下文档：
    -   [日志管理](/cn.zh-CN/应用管理/日志管理/查看实时日志.md)
    -   [监控管理](/cn.zh-CN/监控与报警/监控/基础监控.md)
    -   [应用事件查看](/cn.zh-CN/应用管理/应用变更记录/查看应用事件.md)
    -   [变更记录查看](/cn.zh-CN/应用管理/应用变更记录/查看变更记录.md)
    -   [使用Webshell诊断应用](/cn.zh-CN/应用管理/使用Webshell诊断应用.md)

## 问题反馈

如果您在使用SAE过程中有任何疑问，欢迎您扫描下面的二维码或搜索钉钉群号23198618，加入钉钉群与我们交流。

![SAE钉钉群2](https://static-aliyun-doc.oss-accelerate.aliyuncs.com/assets/img/zh-CN/1176199061/p72048.png)

